<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>Redirecting to Blog...</title>
    <script>
      (function () {
        const path = window.location.pathname;
        const search = window.location.search;
        const hash = window.location.hash;
        const blogDomain = "https://blog.stephen-smj.tech";

        /**
         * 1. White-list: These paths are meant to stay on the main site.
         * Files that physically exist on your server usually won't trigger 404,
         * but we include them here as a safety measure to prevent redirect loops.
         */
        const whiteList = [
          "/",
          "/index.html",
          "/index_cn.html"
        ];

        if (whiteList.includes(path)) {
          // Do nothing if the path is in the white-list
          return;
        }

        /**
         * 2. Redirection Logic
         */
        let target = null;

        // Case A: Specifically handle /about/ paths (e.g., /about/index.html)
        if (path.startsWith("/about/")) {
            target = blogDomain + path;
        }

        // Case B: Handle legacy blog posts (e.g., /2020/07/12/xxx)
        // Matches paths starting with YYYY/MM/DD using Regex
        else if (/^\/\d{4}\/\d{2}\/\d{2}\//.test(path)) {
            target = blogDomain + path;
        }

        // Case C: Functional pages (Tags, Categories, Archives, etc.)
        else if (["/tags/", "/categories/", "/archives/", "/links/", "/moments/"].some(p => path.startsWith(p))) {
            target = blogDomain + path;
        }

        // Case D: Fallback for everything else
        // If the file is not found on the main site, try to find it on the blog
        else {
            target = blogDomain + path;
        }

        /**
         * 3. Execute Redirect
         */
        if (target) {
          // Using .replace() ensures the 404 page doesn't stay in browser history
          window.location.replace(target + search + hash);
        }
      })();
    </script>

    <noscript>
      <meta http-equiv="refresh" content="0; url=https://blog.stephen-smj.tech/" />
    </noscript>
  </head>
  <body style="margin: 50px; font-family: sans-serif; text-align: center;">
    <h2>Page Moved</h2>
    <p>We are redirecting you to our new address...</p>
    <p>If you are not redirected automatically, please click
       <a href="https://blog.stephen-smj.tech/">here to visit our blog</a>.
    </p>
  </body>
</html>